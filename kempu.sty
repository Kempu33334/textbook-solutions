\usepackage[dvipsnames]{xcolor}
\usepackage[most]{tcolorbox}
\usepackage[T1]{fontenc}
\usepackage[top=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[safe]{tipa}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{arcs}
\usepackage{asymptote}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{lmodern}
\usepackage{mathtools}
\usepackage{mdframed}
\usepackage{textcomp}
\usepackage{thmtools}
\usepackage{xparse}

\fontfamily{lmss}\selectfont

\newcommand{\cbrt}[1]{\sqrt[3]{#1}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\ol}[1]{\overline{#1}}
\newcommand{\dangle}{\measuredangle} % For directed angles

\newcommand{\CC}{\mathbb C}
\newcommand{\FF}{\mathbb F}
\newcommand{\NN}{\mathbb N}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\ZZ}{\mathbb Z}

\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\Pow}{\text{Pow}}
\newcommand{\ray}[1]{\overrightarrow{#1}}

\newcommand{\arc}[1]{%
  \mathpalette\arc@math{#1}%
}
\newcommand{\arc@math}[2]{%
  \setbox0=\hbox{$#1#2$}%
  \stackrel{\resizebox{\wd0}{.6ex}{$\frown$}}{\mathord{#1#2}}%
}

\newcommand{\refproblem}[1]{%
  \textcolor{red}{\hyperref[prob:#1]{Problem~#1}}%
}

\captionsetup[figure]{labelformat=empty}

% Define a common theorem style
\tcbset{
  mythestyle/.style={
    breakable,
    enhanced,
    coltitle=black,
    fonttitle=\bfseries,
    boxrule=0pt,
    left=2mm,
    right=2mm,
    top=0.5mm,
    bottom=1mm,
    arc=0pt,
    title filled=false,
    frame hidden,
    toptitle=1mm,
  }
}

% Define environments
\NewTColorBox[auto counter, number within=section]{theorem}{o}{%
  mythestyle,
  colframe=Green!75!black,
  colback=Green!5!white,
  colbacktitle=Green!5!white,
  borderline west={2pt}{0pt}{Green!80!black},
  title={%
    Theorem~\thetcbcounter%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox{theorem*}{o}{%
  mythestyle,
  colframe=Green!75!black,
  colback=Green!5!white,
  colbacktitle=Green!5!white,
  borderline west={2pt}{0pt}{Green!80!black},
  title={%
    Theorem~\thetcbcounter%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox[auto counter, number within=section]{claim}{o}{%
  mythestyle,
  colframe=Blue!75!black,
  colback=Blue!5!white,
  colbacktitle=Blue!5!white,
  borderline west={2pt}{0pt}{Blue!80!black},
  title={%
    Claim~\thetcbcounter%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox{claim*}{o}{%
  mythestyle,
  colframe=Blue!75!black,
  colback=Blue!5!white,
  colbacktitle=Blue!5!white,
  borderline west={2pt}{0pt}{Blue!80!black},
  title={%
    Claim%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox[auto counter, number within=section]{definition}{o}{%
  mythestyle,
  colframe=red!50!black,
  colback=red!5!white,
  colbacktitle=red!5!white,
  borderline west={2pt}{0pt}{red!60!black},
  title={%
    Definition~\thetcbcounter%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox{definition*}{o}{%
  mythestyle,
  colframe=red!50!black,
  colback=red!5!white,
  colbacktitle=red!5!white,
  borderline west={2pt}{0pt}{red!60!black},
  title={%
    Definition%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox[auto counter, number within=section]{remark}{o}{%
  mythestyle,
  colframe=gray!60!black,
  colback=gray!10!white,
  colbacktitle=gray!10!white,
  borderline west={2pt}{0pt}{gray!60!black},
  title={%
    Remark~\thetcbcounter%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\NewTColorBox{remark*}{o}{%
  mythestyle,
  colframe=gray!60!black,
  colback=gray!10!white,
  colbacktitle=gray!10!white,
  borderline west={2pt}{0pt}{gray!60!black},
  title={%
    Remark%
    \IfNoValueTF{#1}{}{(#1)}%
  }
}

\makeatletter
\newtcolorbox{problem}[2][]{%
  enhanced,
  breakable,
  colback=Salmon!5,
  colframe=RawSienna,
  boxrule=0.5pt,
  arc=0pt,
  left=2mm,
  right=2mm,
  bottom=2mm,
  before skip=10pt,
  after skip=10pt,
  top=7.5mm,
  before upper={%
    \edef\@currentlabel{Problem~#1}%
    \phantomsection
    \label{prob:#1}%
  },
  overlay unbroken={
    \node[anchor=north west, font=\bfseries\color{RawSienna}] at ([xshift=2mm,yshift=-2mm]frame.north west)
    {Problem~#1%
    \if\relax\detokenize{#2}\relax\else~(\textnormal{#2})\fi};
  },
  overlay first={
    \node[anchor=north west, font=\bfseries\color{RawSienna}] at ([xshift=2mm,yshift=-2mm]frame.north west)
    {Problem~#1%
    \if\relax\detokenize{#2}\relax\else~(\textnormal{#2})\fi};
  },
}
\makeatother
